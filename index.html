<!doctype html>
<html lang="pt-br" data-bs-theme="dark">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <title>Estacionamento do Tonhão</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>
<link rel="stylesheet" type="text/css" href="estilo.css">

<body>
<style>
  body {
    margin: 0;
    padding: 0;
    background-color: white;
    background-size: cover;
    background-position: center;
}
</style>
<div class="container-fluid text-center">
    <header class="d-flex justify-content-center py-3">
      <ul class="nav nav-pills">
        <button class="btn btn-secondary rounded-pill px-3" id="adicionador">Adicionar Vagas</button>
      </div>
    </header>
  </div>
<br><br>

<div id="vagas">
  <div class="row mb-4 justify-content-center " id="cabeca">
  <div class="col-2 themed-grid-col">vagas</div>
  <div class="col-2 themed-grid-col timer">tempo</div>
  <div class="col-2 themed-grid-col preco">preço</div>
</div>
  <div id="vaga" class="row mb-4 justify-content-center ">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">1</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
  <div id="vaga" class="row mb-4 justify-content-center ">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">2</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
  <div id="vaga" class="row mb-4 justify-content-center ">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">3</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
  <div id="vaga" class="row mb-4 justify-content-center ">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">4</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
  <div id="vaga" class="row mb-4 justify-content-center ">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">5</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
  <div id="vaga" class="row mb-4 justify-content-center ">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">6</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
  <div id="vaga" class="row mb-4 justify-content-center">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">7</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
  <div id="vaga" class="row mb-4 justify-content-center ">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">8</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
  <div id="vaga" class="row mb-4 justify-content-center ">
    <button class="col-2 btn btn-danger rounded-pill px-3 remover">remover</button>
    <div class="col-2 themed-grid-col">9</div>
    <div class="col-2 themed-grid-col timer">00:00</div>
    <div class="col-2 themed-grid-col preco">$5.00</div>
    <button id="referenciaParaCriar" class="col-2 btn btn-light rounded-pill px-3 disponivelVaga livre">livre</button>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", (event) => {
      function initializeVaga(element) {
          let vaga = element.querySelector('.disponivelVaga');
          let timerElement = element.querySelector('.timer');
          let precoElement = element.querySelector('.preco');
          let seconds = 0;
          let price = 5;
          let timerInterval;
  
          function updateTimer() {
              seconds++;
              const minutes = Math.floor(seconds / 60);
              const secs = seconds % 60;
              timerElement.textContent = 
                  (minutes < 10 ? "0" : "") + minutes + ":" + 
                  (secs < 10 ? "0" : "") + secs;
  
              if (seconds % 60 === 0) {
                  price += 2;
                  precoElement.textContent = `$${price.toFixed(2)}`;
              }
          }
  
          function startTimer() {
              timerInterval = setInterval(updateTimer, 1000);
          }
  
          function stopTimer() {
              clearInterval(timerInterval);
          }
  
          // Botão para trocar entre livre e ocupado
          vaga.addEventListener('click', function() {
              if (vaga.classList.contains('livre')) {
                  vaga.classList.toggle("livre");
                  vaga.classList.toggle("ocupado");
                  vaga.textContent = 'ocupado';
                  startTimer(); // Inicia o timer quando a vaga está ocupada
              } else {
                  vaga.classList.toggle("livre");
                  vaga.classList.toggle("ocupado");
                  vaga.textContent = 'livre';
                  stopTimer(); // Para o timer quando a vaga está livre
                  seconds = 0; // Reinicia o timer
                  price = 5; // Reinicia o preço
                  timerElement.textContent = "00:00"; // Reseta o display do timer
                  precoElement.textContent = "$5.00"; // Reseta o display do preço
              }
          });
  
          let removerVaga = element.querySelector('.remover');
          removerVaga.addEventListener('click', function() {
              if (vaga.classList.contains('ocupado')) {
                  alert('A vaga só pode ser removida quando estiver no estado "livre".');
              } else {
                  stopTimer();
                  element.remove();
              }
          });
      }
  
      // Inicializa as vagas existentes
      let elementosVagas = document.querySelectorAll('#vaga');
      elementosVagas.forEach(element => {
          initializeVaga(element);
      });
  
      // Adiciona nova vaga ao clicar no botão
      document.getElementById('adicionador').addEventListener('click', function() {
          const vagas = document.getElementById('vagas');
          const vaga = document.querySelector('#vaga').cloneNode(true);
  
          // Ajusta o índice das vagas
          const index = vagas.children.length + 1;
          vaga.querySelector('.col-2:nth-child(2)').textContent = index;
  
          // Reseta o timer e o preço na nova vaga
          vaga.querySelector('.timer').textContent = "00:00";
          vaga.querySelector('.preco').textContent = "$5.00";
  
          // Adiciona a nova vaga ao contêiner de vagas
          vagas.appendChild(vaga);
  
          // Inicializa a nova vaga
          initializeVaga(vaga);
      });
  });
  </script>

</body>

<script src="script.js"></script>
